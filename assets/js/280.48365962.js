(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{786:function(a,e,l){"use strict";l.r(e);var t=l(1),c=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"ibc-testing-package"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ibc-testing-package"}},[a._v("#")]),a._v(" IBC Testing Package")]),a._v(" "),e("h2",{attrs:{id:"components"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#components"}},[a._v("#")]),a._v(" Components")]),a._v(" "),e("p",[a._v("The testing package comprises of four parts constructed as a stack:")]),a._v(" "),e("ul",[e("li",[a._v("coordinator")]),a._v(" "),e("li",[a._v("chain")]),a._v(" "),e("li",[a._v("path")]),a._v(" "),e("li",[a._v("endpoint")])]),a._v(" "),e("p",[a._v("A coordinator sits at the highest level and contains all the chains which have been initialized.\nIt also stores and updates the current global time. The time is manually incremented by a "),e("code",[a._v("TimeIncrement")]),a._v(".\nThis allows all the chains to remain in synchrony avoiding the issue of a counterparty being perceived to\nbe in the future. The coordinator also contains functions to do basic setup of clients, connections, and channels\nbetween two chains.")]),a._v(" "),e("p",[a._v("A chain is an SDK application (as represented by an app.go file). Inside the chain is an "),e("code",[a._v("TestingApp")]),a._v(" which allows\nthe chain to simulate block production and transaction processing. The chain contains by default a single tendermint\nvalidator. A chain is used to process SDK messages.")]),a._v(" "),e("p",[a._v("A path connects two channel endpoints. It contains all the information needed to relay between two endpoints.")]),a._v(" "),e("p",[a._v("An endpoint represents a channel (and its associated client and connections) on some specific chain. It contains\nreferences to the chain it is on and the counterparty endpoint it is connected to. The endpoint contains functions\nto interact with initialization and updates of its associated clients, connections, and channels. It can send, receive,\nand acknowledge packets.")]),a._v(" "),e("p",[a._v("In general:")]),a._v(" "),e("ul",[e("li",[a._v("endpoints are used for initialization and execution of IBC logic on one side of an IBC connection")]),a._v(" "),e("li",[a._v("paths are used to relay packets")]),a._v(" "),e("li",[a._v("chains are used to commit SDK messages")]),a._v(" "),e("li",[a._v("coordinator is used to setup a path between two chains")])]),a._v(" "),e("h2",{attrs:{id:"integration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#integration"}},[a._v("#")]),a._v(" Integration")]),a._v(" "),e("p",[a._v("To integrate the testing package into your tests, you will need to define:")]),a._v(" "),e("ul",[e("li",[a._v("a testing application")]),a._v(" "),e("li",[a._v("a function to initialize the testing application")])]),a._v(" "),e("h3",{attrs:{id:"testingapp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#testingapp"}},[a._v("#")]),a._v(" TestingApp")]),a._v(" "),e("p",[a._v("Your project will likely already have an application defined. This application\nwill need to be extended to fulfill the "),e("code",[a._v("TestingApp")]),a._v(" interface.")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSBUZXN0aW5nQXBwIGludGVyZmFjZSB7CglhYmNpLkFwcGxpY2F0aW9uCgoJLy8gaWJjLWdvIGFkZGl0aW9ucwoJR2V0QmFzZUFwcCgpICpiYXNlYXBwLkJhc2VBcHAKCUdldFN0YWtpbmdLZWVwZXIoKSBzdGFraW5na2VlcGVyLktlZXBlcgoJR2V0SUJDS2VlcGVyKCkgKmtlZXBlci5LZWVwZXIKCUdldFNjb3BlZElCQ0tlZXBlcigpIGNhcGFiaWxpdHlrZWVwZXIuU2NvcGVkS2VlcGVyCglHZXRUeENvbmZpZygpIGNsaWVudC5UeENvbmZpZwoKCS8vIEltcGxlbWVudGVkIGJ5IFNpbUFwcAoJQXBwQ29kZWMoKSBjb2RlYy5Db2RlYwoKCS8vIEltcGxlbWVudGVkIGJ5IEJhc2VBcHAKCUxhc3RDb21taXRJRCgpIHNkay5Db21taXRJRAoJTGFzdEJsb2NrSGVpZ2h0KCkgaW50NjQKfQo="}}),a._v(" "),e("p",[a._v("To begin, you will need to extend your application by adding the following functions:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gVGVzdGluZ0FwcCBmdW5jdGlvbnMKLy8gRXhhbXBsZSB1c2luZyBTaW1BcHAgdG8gaW1wbGVtZW50IFRlc3RpbmdBcHAKCi8vIEdldEJhc2VBcHAgaW1wbGVtZW50cyB0aGUgVGVzdGluZ0FwcCBpbnRlcmZhY2UuCmZ1bmMgKGFwcCAqU2ltQXBwKSBHZXRCYXNlQXBwKCkgKmJhc2VhcHAuQmFzZUFwcCB7CglyZXR1cm4gYXBwLkJhc2VBcHAKfQoKLy8gR2V0U3Rha2luZ0tlZXBlciBpbXBsZW1lbnRzIHRoZSBUZXN0aW5nQXBwIGludGVyZmFjZS4KZnVuYyAoYXBwICpTaW1BcHApIEdldFN0YWtpbmdLZWVwZXIoKSBzdGFraW5na2VlcGVyLktlZXBlciB7CglyZXR1cm4gYXBwLlN0YWtpbmdLZWVwZXIKfQoKLy8gR2V0SUJDS2VlcGVyIGltcGxlbWVudHMgdGhlIFRlc3RpbmdBcHAgaW50ZXJmYWNlLgpmdW5jIChhcHAgKlNpbUFwcCkgR2V0SUJDS2VlcGVyKCkgKmliY2tlZXBlci5LZWVwZXIgewoJcmV0dXJuIGFwcC5JQkNLZWVwZXIKfQoKLy8gR2V0U2NvcGVkSUJDS2VlcGVyIGltcGxlbWVudHMgdGhlIFRlc3RpbmdBcHAgaW50ZXJmYWNlLgpmdW5jIChhcHAgKlNpbUFwcCkgR2V0U2NvcGVkSUJDS2VlcGVyKCkgY2FwYWJpbGl0eWtlZXBlci5TY29wZWRLZWVwZXIgewoJcmV0dXJuIGFwcC5TY29wZWRJQkNLZWVwZXIKfQoKLy8gR2V0VHhDb25maWcgaW1wbGVtZW50cyB0aGUgVGVzdGluZ0FwcCBpbnRlcmZhY2UuCmZ1bmMgKGFwcCAqU2ltQXBwKSBHZXRUeENvbmZpZygpIGNsaWVudC5UeENvbmZpZyB7CglyZXR1cm4gTWFrZVRlc3RFbmNvZGluZ0NvbmZpZygpLlR4Q29uZmlnCn0KCg=="}}),a._v(" "),e("p",[a._v("Your application may need to define "),e("code",[a._v("AppCodec()")]),a._v(" if it does not already exist:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gQXBwQ29kZWMgcmV0dXJucyBTaW1BcHAncyBhcHAgY29kZWMuCi8vCi8vIE5PVEU6IFRoaXMgaXMgc29sZWx5IHRvIGJlIHVzZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMgYXMgaXQgbWF5IGJlIGRlc2lyYWJsZQovLyBmb3IgbW9kdWxlcyB0byByZWdpc3RlciB0aGVpciBvd24gY3VzdG9tIHRlc3RpbmcgdHlwZXMuCmZ1bmMgKGFwcCAqU2ltQXBwKSBBcHBDb2RlYygpIGNvZGVjLkNvZGVjIHsKCXJldHVybiBhcHAuYXBwQ29kZWMKfQo="}}),a._v(" "),e("p",[a._v("It is assumed your application contains an embedded BaseApp and thus implements the abci.Application interface,\n"),e("code",[a._v("LastCommitID()")]),a._v(" and "),e("code",[a._v("LastBlockHeight()")])]),a._v(" "),e("h3",{attrs:{id:"initialize-testingapp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#initialize-testingapp"}},[a._v("#")]),a._v(" Initialize TestingApp")]),a._v(" "),e("p",[a._v("The testing package requires that you provide a function to initialize your TestingApp.\nThis is how ibc-go implements the initialize function with its "),e("code",[a._v("SimApp")]),a._v(":")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBTZXR1cFRlc3RpbmdBcHAoKSAoVGVzdGluZ0FwcCwgbWFwW3N0cmluZ11qc29uLlJhd01lc3NhZ2UpIHsKCWRiIDo9IGRibS5OZXdNZW1EQigpCgllbmNDZGMgOj0gc2ltYXBwLk1ha2VUZXN0RW5jb2RpbmdDb25maWcoKQoJYXBwIDo9IHNpbWFwcC5OZXdTaW1BcHAobG9nLk5ld05vcExvZ2dlcigpLCBkYiwgbmlsLCB0cnVlLCBtYXBbaW50NjRdYm9vbHt9LCBzaW1hcHAuRGVmYXVsdE5vZGVIb21lLCA1LCBlbmNDZGMsIHNpbWFwcC5FbXB0eUFwcE9wdGlvbnN7fSkKCXJldHVybiBhcHAsIHNpbWFwcC5OZXdEZWZhdWx0R2VuZXNpc1N0YXRlKGVuY0NkYy5NYXJzaGFsZXIpCn0K"}}),a._v(" "),e("p",[a._v("This function returns the TestingApp and the default genesis state used to initialize the testing app.")]),a._v(" "),e("p",[a._v("Change the value of "),e("code",[a._v("DefaultTestingAppInit")]),a._v(" to use your function:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBpbml0KCkgewogICAgaWJjdGVzdGluZy5EZWZhdWx0VGVzdGluZ0FwcEluaXQgPSBNeVNldHVwVGVzdGluZ0FwcEZ1bmN0aW9uCn0KCg=="}}),a._v(" "),e("h2",{attrs:{id:"example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[a._v("#")]),a._v(" Example")]),a._v(" "),e("p",[a._v("Here is an example of how to setup your testing environment in every package you are testing:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gS2VlcGVyVGVzdFN1aXRlIGlzIGEgdGVzdGluZyBzdWl0ZSB0byB0ZXN0IGtlZXBlciBmdW5jdGlvbnMuCnR5cGUgS2VlcGVyVGVzdFN1aXRlIHN0cnVjdCB7CglzdWl0ZS5TdWl0ZQoKCWNvb3JkaW5hdG9yICppYmN0ZXN0aW5nLkNvb3JkaW5hdG9yCgoJLy8gdGVzdGluZyBjaGFpbnMgdXNlZCBmb3IgY29udmVuaWVuY2UgYW5kIHJlYWRhYmlsaXR5CgljaGFpbkEgKmliY3Rlc3RpbmcuVGVzdENoYWluCgljaGFpbkIgKmliY3Rlc3RpbmcuVGVzdENoYWluCn0KCi8vIFRlc3RLZWVwZXJUZXN0U3VpdGUgcnVucyBhbGwgdGhlIHRlc3RzIHdpdGhpbiB0aGlzIHBhY2thZ2UuCmZ1bmMgVGVzdEtlZXBlclRlc3RTdWl0ZSh0ICp0ZXN0aW5nLlQpIHsKCXN1aXRlLlJ1bih0LCBuZXcoS2VlcGVyVGVzdFN1aXRlKSkKfQoKLy8gU2V0dXBUZXN0IGNyZWF0ZXMgYSBjb29yZGluYXRvciB3aXRoIDIgdGVzdCBjaGFpbnMuCmZ1bmMgKHN1aXRlICpLZWVwZXJUZXN0U3VpdGUpIFNldHVwVGVzdCgpIHsKCXN1aXRlLmNvb3JkaW5hdG9yID0gaWJjdGVzdGluZy5OZXdDb29yZGluYXRvcihzdWl0ZS5UKCksIDIpIC8vIGluaXRpYWxpemVzIDIgdGVzdCBjaGFpbnMKCXN1aXRlLmNoYWluQSA9IHN1aXRlLmNvb3JkaW5hdG9yLkdldENoYWluKGliY3Rlc3RpbmcuR2V0Q2hhaW5JRCgxKSkgLy8gY29udmVuaWVuY2UgYW5kIHJlYWRhYmlsaXR5CglzdWl0ZS5jaGFpbkIgPSBzdWl0ZS5jb29yZGluYXRvci5HZXRDaGFpbihpYmN0ZXN0aW5nLkdldENoYWluSUQoMikpIC8vIGNvbnZlbmllbmNlIGFuZCByZWFkYWJpbGl0eQp9Cg=="}}),a._v(" "),e("p",[a._v("To create interaction between chainA and chainB, we need to contruct a "),e("code",[a._v("Path")]),a._v(" these chains will use.\nA path contains two endpoints, "),e("code",[a._v("EndpointA")]),a._v(" and "),e("code",[a._v("EndpointB")]),a._v(" (corresponding to the order of the chains passed\ninto the "),e("code",[a._v("NewPath")]),a._v(" function). A path is a pointer and its values will be filled in as necessary during the\nsetup portion of testing.")]),a._v(" "),e("p",[a._v("Endpoint Struct:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gRW5kcG9pbnQgaXMgYSB3aGljaCByZXByZXNlbnRzIGEgY2hhbm5lbCBlbmRwb2ludCBhbmQgaXRzIGFzc29jaWF0ZWQKLy8gY2xpZW50IGFuZCBjb25uZWN0aW9ucy4gSXQgY29udGFpbnMgY2xpZW50LCBjb25uZWN0aW9uLCBhbmQgY2hhbm5lbAovLyBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMuIEVuZHBvaW50IGZ1bmN0aW9ucyB3aWxsIHV0aWxpemUgdGhlIHBhcmFtZXRlcnMKLy8gc2V0IGluIHRoZSBjb25maWd1cmF0aW9uIHN0cnVjdHMgd2hlbiBleGVjdXRpbmcgSUJDIG1lc3NhZ2VzLgp0eXBlIEVuZHBvaW50IHN0cnVjdCB7CglDaGFpbiAgICAgICAgKlRlc3RDaGFpbgoJQ291bnRlcnBhcnR5ICpFbmRwb2ludAoJQ2xpZW50SUQgICAgIHN0cmluZwoJQ29ubmVjdGlvbklEIHN0cmluZwoJQ2hhbm5lbElEICAgIHN0cmluZwoKCUNsaWVudENvbmZpZyAgICAgQ2xpZW50Q29uZmlnCglDb25uZWN0aW9uQ29uZmlnICpDb25uZWN0aW9uQ29uZmlnCglDaGFubmVsQ29uZmlnICAgICpDaGFubmVsQ29uZmlnCn0K"}}),a._v(" "),e("p",[a._v("The fields empty after "),e("code",[a._v("NewPath")]),a._v(" is called are "),e("code",[a._v("ClientID")]),a._v(", "),e("code",[a._v("ConnectionID")]),a._v(" and\n"),e("code",[a._v("ChannelID")]),a._v(" as the clients, connections, and channels for these endpoints have not yet been created. The\n"),e("code",[a._v("ClientConfig")]),a._v(", "),e("code",[a._v("ConnectionConfig")]),a._v(" and "),e("code",[a._v("ChannelConfig")]),a._v(" contain all the necessary information for clients,\nconnections, and channels to be initialized. If you would like to use endpoints which are initialized to\nuse your Port IDs, you might add a helper function similar to the one found in transfer:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBOZXdUcmFuc2ZlclBhdGgoY2hhaW5BLCBjaGFpbkIgKmliY3Rlc3RpbmcuVGVzdENoYWluKSAqaWJjdGVzdGluZy5QYXRoIHsKCXBhdGggOj0gaWJjdGVzdGluZy5OZXdQYXRoKGNoYWluQSwgY2hhaW5CKQoJcGF0aC5FbmRwb2ludEEuQ2hhbm5lbENvbmZpZy5Qb3J0SUQgPSBpYmN0ZXN0aW5nLlRyYW5zZmVyUG9ydAoJcGF0aC5FbmRwb2ludEIuQ2hhbm5lbENvbmZpZy5Qb3J0SUQgPSBpYmN0ZXN0aW5nLlRyYW5zZmVyUG9ydAoKCXJldHVybiBwYXRoCn0KCg=="}}),a._v(" "),e("p",[a._v("Path configurations should be set to the desired values before calling any "),e("code",[a._v("Setup")]),a._v(" coordinator functions.")]),a._v(" "),e("p",[a._v("To initialize the clients, connections, and channels for a path we can call the Setup functions of the coordinator:")]),a._v(" "),e("ul",[e("li",[a._v("Setup() -> setup clients, connections, channels")]),a._v(" "),e("li",[a._v("SetupClients() -> setup clients only")]),a._v(" "),e("li",[a._v("SetupConnections() -> setup clients and connections only")])]),a._v(" "),e("p",[a._v("Here is a basic example of the testing package being used to simulate IBC functionality:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ICAgIHBhdGggOj0gaWJjdGVzdGluZy5OZXdQYXRoKHN1aXRlLmNoYWluQSwgc3VpdGUuY2hhaW5CKSAvLyBjbGllbnRJRCwgY29ubmVjdGlvbklELCBjaGFubmVsSUQgZW1wdHkKICAgIHN1aXRlLmNvb3JkaW5hdG9yLlNldHVwKHBhdGgpIC8vIGNsaWVudElELCBjb25uZWN0aW9uSUQsIGNoYW5uZWxJRCBmaWxsZWQKICAgIHN1aXRlLlJlcXVpcmUoKS5FcXVhbCgmcXVvdDswNy10ZW5kZXJtaW50LTAmcXVvdDssIHBhdGguRW5kcG9pbnRBLkNsaWVudElEKQogICAgc3VpdGUuUmVxdWlyZSgpLkVxdWFsKCZxdW90O2Nvbm5lY3Rpb24tMCZxdW90OywgcGF0aC5FbmRwb2ludEEuQ2xpZW50SUQpCiAgICBzdWl0ZS5SZXF1aXJlKCkuRXF1YWwoJnF1b3Q7Y2hhbm5lbC0wJnF1b3Q7LCBwYXRoLkVuZHBvaW50QS5DbGllbnRJRCkKCiAgICAvLyBjcmVhdGUgcGFja2V0IDEgCiAgICBwYWNrZXQxIDo9IE5ld1BhY2tldCgpIC8vIE5ld1BhY2tldCB3b3VsZCBjb25zdHJ1Y3QgeW91ciBwYWNrZXQKCiAgICAvLyBzZW5kIG9uIGVuZHBvaW50QQogICAgcGF0aC5FbmRwb2ludEEuU2VuZFBhY2tldChwYWNrZXQxKQoKICAgIC8vIHJlY2VpdmUgb24gZW5kcG9pbnRCCiAgICBwYXRoLkVuZHBvaW50Qi5SZWN2UGFja2V0KHBhY2tldDEpCgogICAgLy8gYWNrbm93bGVkZ2UgdGhlIHJlY2VpcHQgb2YgdGhlIHBhY2tldAogICAgcGF0aC5FbmRwb2ludEEuQWNrbm93bGVkZ2VQYWNrZXQocGFja2V0MSwgYWNrKQoKICAgIC8vIHdlIGNhbiBhbHNvIHJlbGF5CiAgICBwYWNrZXQyIDo9IE5ld1BhY2tldCgpCgogICAgcGF0aC5FbmRwb2ludEEuU2VuZFBhY2tldChwYWNrZXQyKQoKICAgIHBhdGguUmVsYXkocGFja2V0MiwgZXhwZWN0ZWRBY2spCgogICAgLy8gaWYgbmVlZGVkIHdlIGNhbiB1cGRhdGUgb3VyIGNsaWVudHMKICAgIHBhdGguRW5kcG9pbnRCLlVwZGF0ZUNsaWVudCgpICAgIAo="}}),a._v(" "),e("h3",{attrs:{id:"transfer-testing-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#transfer-testing-example"}},[a._v("#")]),a._v(" Transfer Testing Example")]),a._v(" "),e("p",[a._v("If ICS 20 had its own simapp, its testing setup might include a "),e("code",[a._v("testing/app.go")]),a._v(" file with the following contents:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSB0cmFuc2ZlcnRlc3RpbmcKCmltcG9ydCAoCgkmcXVvdDtlbmNvZGluZy9qc29uJnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS9jb21ldGJmdC9jb21ldGJmdC9saWJzL2xvZyZxdW90OwoJZGJtICZxdW90O2dpdGh1Yi5jb20vY29tZXRiZnQvY29tZXRiZnQtZGImcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9pYmMtZ28vdjYvbW9kdWxlcy9hcHBzL3RyYW5zZmVyL3NpbWFwcCZxdW90OwoJaWJjdGVzdGluZyAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9pYmMtZ28vdjYvdGVzdGluZyZxdW90OwopCgpmdW5jIFNldHVwVHJhbnNmZXJUZXN0aW5nQXBwKCkgKGliY3Rlc3RpbmcuVGVzdGluZ0FwcCwgbWFwW3N0cmluZ11qc29uLlJhd01lc3NhZ2UpIHsKCWRiIDo9IGRibS5OZXdNZW1EQigpCgllbmNDZGMgOj0gc2ltYXBwLk1ha2VUZXN0RW5jb2RpbmdDb25maWcoKQoJYXBwIDo9IHNpbWFwcC5OZXdTaW1BcHAobG9nLk5ld05vcExvZ2dlcigpLCBkYiwgbmlsLCB0cnVlLCBtYXBbaW50NjRdYm9vbHt9LCBzaW1hcHAuRGVmYXVsdE5vZGVIb21lLCA1LCBlbmNDZGMsIHNpbWFwcC5FbXB0eUFwcE9wdGlvbnN7fSkKCXJldHVybiBhcHAsIHNpbWFwcC5OZXdEZWZhdWx0R2VuZXNpc1N0YXRlKGVuY0NkYy5NYXJzaGFsZXIpCn0KCmZ1bmMgaW5pdCgpIHsKCWliY3Rlc3RpbmcuRGVmYXVsdFRlc3RpbmdBcHBJbml0ID0gU2V0dXBUcmFuc2ZlclRlc3RpbmdBcHAKfQoKZnVuYyBOZXdUcmFuc2ZlclBhdGgoY2hhaW5BLCBjaGFpbkIgKmliY3Rlc3RpbmcuVGVzdENoYWluKSAqaWJjdGVzdGluZy5QYXRoIHsKCXBhdGggOj0gaWJjdGVzdGluZy5OZXdQYXRoKGNoYWluQSwgY2hhaW5CKQoJcGF0aC5FbmRwb2ludEEuQ2hhbm5lbENvbmZpZy5Qb3J0SUQgPSBpYmN0ZXN0aW5nLlRyYW5zZmVyUG9ydAoJcGF0aC5FbmRwb2ludEIuQ2hhbm5lbENvbmZpZy5Qb3J0SUQgPSBpYmN0ZXN0aW5nLlRyYW5zZmVyUG9ydAoKCXJldHVybiBwYXRoCn0KCmZ1bmMgR2V0VHJhbnNmZXJTaW1BcHAoY2hhaW4gKmliY3Rlc3RpbmcuVGVzdENoYWluKSAqc2ltYXBwLlNpbUFwcCB7CglhcHAsIG9rIDo9IGNoYWluLkFwcC4oKnNpbWFwcC5TaW1BcHApCglpZiAhb2sgewoJCXBhbmljKCZxdW90O25vdCB0cmFuc2ZlciBhcHAmcXVvdDspCgl9CgoJcmV0dXJuIGFwcAp9Cg=="}}),a._v(" "),e("h3",{attrs:{id:"middleware-testing"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#middleware-testing"}},[a._v("#")]),a._v(" Middleware Testing")]),a._v(" "),e("p",[a._v("When writing IBC applications acting as middleware, it might be desirable to test integration points.\nThis can be done by wiring a middleware stack in the app.go file\nusing existing applications as middleware and IBC base applications.\nThe mock module may also be leveraged to act as a base application in the instance\nthat such an application is not available for testing or causes dependency concerns.")]),a._v(" "),e("p",[a._v("The mock IBC module contains a "),e("code",[a._v("MockIBCApp")]),a._v(". This struct contains a function field for every IBC App Module callback.\nEach of these functions can be individually set to mock expected behavior of a base application.")]),a._v(" "),e("p",[a._v("For example, if one wanted to test that the base application cannot affect the outcome of the "),e("code",[a._v("OnChanOpenTry")]),a._v(" callback,\nthe mock module base application callback could be updated as such:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ICAgIG1vY2tNb2R1bGUuSUJDQXBwLk9uQ2hhbk9wZW5UcnkgPSBmdW5jKGN0eCBzZGsuQ29udGV4dCwgcG9ydElELCBjaGFubmVsSUQsIHZlcnNpb24gc3RyaW5nKSBlcnJvciB7CgkJCXJldHVybiBmbXQuRXJyb3JmKCZxdW90O21vY2sgYmFzZSBhcHAgbXVzdCBub3QgYmUgY2FsbGVkIGZvciBPbkNoYW5PcGVuVHJ5JnF1b3Q7KQoJfQo="}}),a._v(" "),e("p",[a._v("Using a mock module as a base application in a middleware stack may require adding the module to your "),e("code",[a._v("SimApp")]),a._v(".\nThis is because IBC will route to the top level IBC module of a middleware stack, so a module which never\nsits at the top of middleware stack will need to be accessed via a public field in "),e("code",[a._v("SimApp")])]),a._v(" "),e("p",[a._v("This might look like:")]),a._v(" "),e("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ICAgIHN1aXRlLmNoYWluQS5HZXRTaW1BcHAoKS5JQ0FBdXRoTW9kdWxlLklCQ0FwcC5PbkNoYW5PcGVuSW5pdCA9IGZ1bmMoY3R4IHNkay5Db250ZXh0LCBvcmRlciBjaGFubmVsdHlwZXMuT3JkZXIsIGNvbm5lY3Rpb25Ib3BzIFtdc3RyaW5nLAoJCXBvcnRJRCwgY2hhbm5lbElEIHN0cmluZywgY2hhbkNhcCAqY2FwYWJpbGl0eXR5cGVzLkNhcGFiaWxpdHksCgkJY291bnRlcnBhcnR5IGNoYW5uZWx0eXBlcy5Db3VudGVycGFydHksIHZlcnNpb24gc3RyaW5nLAoJKSBlcnJvciB7CgkJcmV0dXJuIGZtdC5FcnJvcmYoJnF1b3Q7bW9jayBpY2EgYXV0aCBmYWlscyZxdW90OykKCX0K"}})],1)}),[],!1,null,null,null);e.default=c.exports}}]);